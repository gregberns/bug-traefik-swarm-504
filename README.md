# Bug or Config Issue: Traefik Swarm times out with 504

When a simple service is configured to be read from Docker Swarm, Traefik recieves the information about the service, but when requests are routed to the service they fail with a `504 Gateway Timeout` error.

## Solution

`traefik.docker.network` is required when configuring Docker Swarm when there are multiple networks involved.

Thanks to: https://github.com/containous/traefik/issues/3535

Docs PR: https://github.com/containous/traefik/pull/4751

## Reproduce

```
git clone https://github.com/gregberns/bug-traefik-swarm-504.git
cd bug-traefik-swarm-504
docker stack deploy -c docker-compose.yml api
docker service ls # find the 'api_traefik' service
curl http://localhost/service1 # this will timeout
docker service logs <traefik service id>
```

## Versions

Traefik:

`traefik:1.7`

Docker: 

`docker --version`: `Docker version 18.09.1, build 4c52b90`

## Logs

Issue is that the request to `server1` fails with a `504`:

```
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | 10.255.0.2 - - [09/Apr/2019:03:34:17 +0000] "GET /service1 HTTP/1.1" 504 15 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36" 1 "Host-localhost-PathPrefixStrip-service1-0" "http://10.255.0.133:80" 29976ms
```

At `2019-04-09T03:34:24Z` you can see that `service1` gets loaded from docker swarm, so Traefik does know about it.

See the last part of the log for the 504.

```
$ docker service logs rz5
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Using TOML configuration file /traefik.toml"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Traefik version v1.7.10 built on 2019-03-29_12:20:34PM"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=debug msg="Global configuration loaded {\"LifeCycle\":{\"RequestAcceptGraceTimeout\":0,\"GraceTimeOut\":10000000000},\"GraceTimeOut\":0,\"Debug\":false,\"CheckNewVersion\":true,\"SendAnonymousUsage\":false,\"AccessLogsFile\":\"\",\"AccessLog\":{\"format\":\"common\"},\"TraefikLogsFile\":\"\",\"TraefikLog\":null,\"Tracing\":null,\"LogLevel\":\"DEBUG\",\"EntryPoints\":{\"http\":{\"Address\":\":80\",\"TLS\":null,\"Redirect\":null,\"Auth\":null,\"WhitelistSourceRange\":null,\"WhiteList\":null,\"Compress\":false,\"ProxyProtocol\":null,\"ForwardedHeaders\":{\"Insecure\":true,\"TrustedIPs\":null}},\"traefik\":{\"Address\":\":8080\",\"TLS\":null,\"Redirect\":null,\"Auth\":null,\"WhitelistSourceRange\":null,\"WhiteList\":null,\"Compress\":false,\"ProxyProtocol\":null,\"ForwardedHeaders\":{\"Insecure\":true,\"TrustedIPs\":null}}},\"Cluster\":null,\"Constraints\":[],\"ACME\":null,\"DefaultEntryPoints\":[\"http\"],\"ProvidersThrottleDuration\":2000000000,\"MaxIdleConnsPerHost\":200,\"IdleTimeout\":0,\"InsecureSkipVerify\":false,\"RootCAs\":null,\"Retry\":null,\"HealthCheck\":{\"Interval\":30000000000},\"RespondingTimeouts\":null,\"ForwardingTimeouts\":null,\"AllowMinWeightZero\":false,\"KeepTrailingSlash\":false,\"Web\":null,\"Docker\":{\"Watch\":true,\"Filename\":\"\",\"Constraints\":null,\"Trace\":false,\"TemplateVersion\":2,\"DebugLogGeneratedTemplate\":false,\"Endpoint\":\"unix:///var/run/docker.sock\",\"Domain\":\"\",\"TLS\":null,\"ExposedByDefault\":true,\"UseBindPortIP\":false,\"SwarmMode\":true,\"Network\":\"\",\"SwarmModeRefreshSeconds\":15},\"File\":null,\"Marathon\":null,\"Consul\":null,\"ConsulCatalog\":null,\"Etcd\":null,\"Zookeeper\":null,\"Boltdb\":null,\"Kubernetes\":null,\"Mesos\":null,\"Eureka\":null,\"ECS\":null,\"Rancher\":null,\"DynamoDB\":null,\"ServiceFabric\":null,\"Rest\":null,\"API\":{\"EntryPoint\":\"traefik\",\"Dashboard\":true,\"Debug\":false,\"CurrentConfigurations\":null,\"Statistics\":null},\"Metrics\":null,\"Ping\":null,\"HostResolver\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="\nStats collection is disabled.\nHelp us improve Traefik by turning this feature on :)\nMore details on: https://docs.traefik.io/basics/#collected-data\n"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Preparing server http &{Address::80 TLS:<nil> Redirect:<nil> Auth:<nil> WhitelistSourceRange:[] WhiteList:<nil> Compress:false ProxyProtocol:<nil> ForwardedHeaders:0xc0003cf100} with readTimeout=0s writeTimeout=0s idleTimeout=3m0s"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Preparing server traefik &{Address::8080 TLS:<nil> Redirect:<nil> Auth:<nil> WhitelistSourceRange:[] WhiteList:<nil> Compress:false ProxyProtocol:<nil> ForwardedHeaders:0xc0003cf120} with readTimeout=0s writeTimeout=0s idleTimeout=3m0s"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Starting server on :80"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Starting provider configuration.ProviderAggregator {}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Starting server on :8080"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Starting provider *docker.Provider {\"Watch\":true,\"Filename\":\"\",\"Constraints\":null,\"Trace\":false,\"TemplateVersion\":2,\"DebugLogGeneratedTemplate\":false,\"Endpoint\":\"unix:///var/run/docker.sock\",\"Domain\":\"\",\"TLS\":null,\"ExposedByDefault\":true,\"UseBindPortIP\":false,\"SwarmMode\":true,\"Network\":\"\",\"SwarmModeRefreshSeconds\":15}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=debug msg="Provider connection established with docker 18.09.1 (API 1.39)"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=debug msg="Configuration received from provider docker: {}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Server configuration reloaded on :8080"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:33:54Z" level=info msg="Server configuration reloaded on :80"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="originLabelsmap[com.docker.stack.image:containous/whoami com.docker.stack.namespace:api traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="allLabelsmap[:map[traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="originLabelsmap[com.docker.stack.image:traefik:1.7 com.docker.stack.namespace:api]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="allLabelsmap[:map[]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Filtering container with empty frontend rule api_reverse-proxy.1 "
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="originLabelsmap[traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80 com.docker.stack.image:containous/whoami com.docker.stack.namespace:api]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="allLabelsmap[:map[traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80 traefik.backend:service1]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Backend backend-service1: no load-balancer defined, fallback to 'wrr' method"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Configuration received from provider docker: {\"backends\":{\"backend-service1\":{\"servers\":{\"server-api-service1-1-e1698967aee5f612055761081b8140de\":{\"url\":\"http://10.255.0.133:80\",\"weight\":1}},\"loadBalancer\":{\"method\":\"wrr\"}}},\"frontends\":{\"frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"entryPoints\":[\"http\"],\"backend\":\"backend-service1\",\"routes\":{\"route-frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"rule\":\"Host:localhost;PathPrefixStrip:/service1\"}},\"passHostHeader\":true,\"priority\":0,\"basicAuth\":null}}}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Wiring frontend frontend-Host-localhost-PathPrefixStrip-service1-0 to entryPoint http"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Creating backend backend-service1"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Adding TLSClientHeaders middleware for frontend frontend-Host-localhost-PathPrefixStrip-service1-0"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Creating load-balancer wrr"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Creating server server-api-service1-1-e1698967aee5f612055761081b8140de at http://10.255.0.133:80 with weight 1"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=debug msg="Creating route route-frontend-Host-localhost-PathPrefixStrip-service1-0 Host:localhost;PathPrefixStrip:/service1"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=info msg="Server configuration reloaded on :8080"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:09Z" level=info msg="Server configuration reloaded on :80"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:17Z" level=debug msg="vulcand/oxy/roundrobin/rr: begin ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"\",\"Opaque\":\"\",\"User\":null,\"Host\":\"\",\"Path\":\"/\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:17Z" level=debug msg="vulcand/oxy/roundrobin/rr: Forwarding this request to URL" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"\",\"Opaque\":\"\",\"User\":null,\"Host\":\"\",\"Path\":\"/\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}" ForwardURL="http://10.255.0.133:80"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:17Z" level=debug msg="vulcand/oxy/forward: begin ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"http\",\"Opaque\":\"\",\"User\":null,\"Host\":\"10.255.0.133:80\",\"Path\":\"\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:17Z" level=debug msg="vulcand/oxy/forward/http: begin ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"http\",\"Opaque\":\"\",\"User\":null,\"Host\":\"10.255.0.133:80\",\"Path\":\"\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:17Z" level=debug msg="Upstream ResponseWriter of type *pipelining.writerWithoutCloseNotify does not implement http.CloseNotifier. Returning dummy channel."
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="originLabelsmap[traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80 com.docker.stack.image:containous/whoami com.docker.stack.namespace:api traefik.backend:service1 traefik.enable:true]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="allLabelsmap[:map[traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80 traefik.backend:service1 traefik.enable:true]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="originLabelsmap[com.docker.stack.image:traefik:1.7 com.docker.stack.namespace:api]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="allLabelsmap[:map[]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="Filtering container with empty frontend rule api_reverse-proxy.1 "
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="originLabelsmap[com.docker.stack.image:containous/whoami com.docker.stack.namespace:api traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="allLabelsmap[:map[traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="Backend backend-service1: no load-balancer defined, fallback to 'wrr' method"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=debug msg="Configuration received from provider docker: {\"backends\":{\"backend-service1\":{\"servers\":{\"server-api-service1-1-e1698967aee5f612055761081b8140de\":{\"url\":\"http://10.255.0.133:80\",\"weight\":1}},\"loadBalancer\":{\"method\":\"wrr\"}}},\"frontends\":{\"frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"entryPoints\":[\"http\"],\"backend\":\"backend-service1\",\"routes\":{\"route-frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"rule\":\"Host:localhost;PathPrefixStrip:/service1\"}},\"passHostHeader\":true,\"priority\":0,\"basicAuth\":null}}}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:24Z" level=info msg="Skipping same configuration for provider docker"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="originLabelsmap[com.docker.stack.image:containous/whoami com.docker.stack.namespace:api traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="allLabelsmap[:map[traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="originLabelsmap[com.docker.stack.image:traefik:1.7 com.docker.stack.namespace:api]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="allLabelsmap[:map[]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="Filtering container with empty frontend rule api_reverse-proxy.1 "
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="originLabelsmap[com.docker.stack.image:containous/whoami com.docker.stack.namespace:api traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="allLabelsmap[:map[traefik.backend:service1 traefik.enable:true traefik.frontend.rule:Host:localhost;PathPrefixStrip:/service1 traefik.port:80]]"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="Backend backend-service1: no load-balancer defined, fallback to 'wrr' method"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=debug msg="Configuration received from provider docker: {\"backends\":{\"backend-service1\":{\"servers\":{\"server-api-service1-1-e1698967aee5f612055761081b8140de\":{\"url\":\"http://10.255.0.133:80\",\"weight\":1}},\"loadBalancer\":{\"method\":\"wrr\"}}},\"frontends\":{\"frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"entryPoints\":[\"http\"],\"backend\":\"backend-service1\",\"routes\":{\"route-frontend-Host-localhost-PathPrefixStrip-service1-0\":{\"rule\":\"Host:localhost;PathPrefixStrip:/service1\"}},\"passHostHeader\":true,\"priority\":0,\"basicAuth\":null}}}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:38Z" level=info msg="Skipping same configuration for provider docker"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:47Z" level=debug msg="'504 Gateway Timeout' caused by: dial tcp 10.255.0.133:80: i/o timeout"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:47Z" level=debug msg="vulcand/oxy/forward/http: Round trip: http://10.255.0.133:80, code: 504, Length: 15, duration: 29.9702713s"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:47Z" level=debug msg="vulcand/oxy/forward/http: completed ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"http\",\"Opaque\":\"\",\"User\":null,\"Host\":\"10.255.0.133:80\",\"Path\":\"\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:47Z" level=debug msg="vulcand/oxy/forward: completed ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"http\",\"Opaque\":\"\",\"User\":null,\"Host\":\"10.255.0.133:80\",\"Path\":\"\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | time="2019-04-09T03:34:47Z" level=debug msg="vulcand/oxy/roundrobin/rr: completed ServeHttp on request" Request="{\"Method\":\"GET\",\"URL\":{\"Scheme\":\"\",\"Opaque\":\"\",\"User\":null,\"Host\":\"\",\"Path\":\"/\",\"RawPath\":\"\",\"ForceQuery\":false,\"RawQuery\":\"\",\"Fragment\":\"\"},\"Proto\":\"HTTP/1.1\",\"ProtoMajor\":1,\"ProtoMinor\":1,\"Header\":{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"],\"Accept-Encoding\":[\"gzip, deflate, br\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Dnt\":[\"1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"],\"X-Forwarded-Prefix\":[\"/service1\"]},\"ContentLength\":0,\"TransferEncoding\":null,\"Host\":\"localhost\",\"Form\":null,\"PostForm\":null,\"MultipartForm\":null,\"Trailer\":null,\"RemoteAddr\":\"10.255.0.2:37378\",\"RequestURI\":\"/\",\"TLS\":null}"
api_reverse-proxy.1.y14kv67a0mdk@linuxkit-025000000001    | 10.255.0.2 - - [09/Apr/2019:03:34:17 +0000] "GET /service1 HTTP/1.1" 504 15 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36" 1 "Host-localhost-PathPrefixStrip-service1-0" "http://10.255.0.133:80" 29976ms
```

## Config

